try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b658edbf-0c3e-4bda-9ffb-58561cce53a4",e._sentryDebugIdIdentifier="sentry-dbid-b658edbf-0c3e-4bda-9ffb-58561cce53a4")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[694],{13393:(e,t,r)=>{r.d(t,{i:()=>o,T:()=>h});var n=r(30328);let a=r(55821).N.get("NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY"),i=null,o={then:(e,t)=>(i||(i=(0,n.c)(a)),i.then(e,t))};var s=r(12115),l=r(34272),c=r(23544),d=r(44827),u=r(37315),g=r(48963),m=r(59185),p=r(44915);async function f(e){let{workspaceId:t,rewardfulReferralId:r}=e;if("string"!=typeof t)throw Error("Invalid workspace id.");return(await m.A.post("/api/workspace/customer/fetch-or-create",{workspaceId:t,rewardfulReferralId:r})).data.stripeCustomer}function h(){let e=(0,l.o)(),t=function(){let e=(0,p.y)();return(0,g.n)(f,{onSuccess:async()=>{await e()}})}();(0,s.useEffect)(()=>{var r,n;if(!e||t.isLoading||t.isError)return;let a=null==e||null==(r=e.allWorkspaces)?void 0:r.map(e=>e.workspace).filter(e=>!e.stripeCustomer);if(void 0!==a){for(let e of a)t.mutate({workspaceId:e.id,rewardfulReferralId:null==(n=window.Rewardful)?void 0:n.referral});if(0!==a.length){c.L.track("Client Side Signed Up",void 0);let t=null==e?void 0:e.user.id;void 0!==t&&((0,u.gD)({userId:t}),(0,d.LV)({userId:t}))}}},[t,e])}},16210:(e,t,r)=>{r.d(t,{e:()=>w});var n=r(76367),a=r(30694),i=r(95155),o=r(12115),s=r(6619),l=r(91688),c=r.n(l),d=r(34272),u=r(76882),g=r(93833),m=r(88028),p=r(79929),f=r(49084),h=r(67768),v=r(76996);function y(e){let t=(0,d.o)(),r=(0,v.Re)();if(!t)return null;let n=e.seatChangePreview.data.originalQuantity,a=e.seatChangePreview.data.upcomingInvoice.subscription_items[0].quantity,o=a-n;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.rQ,{startItems:e.onBack?(0,i.jsx)(s.Hp,{icon:m.A,onClick:e.onBack,disabled:e.loading}):void 0,"data-sentry-element":"ModalHeader","data-sentry-source-file":"SeatChangeModalContent.tsx"}),(0,i.jsx)(s.cw,{"data-sentry-element":"ModalBody","data-sentry-source-file":"SeatChangeModalContent.tsx",children:(0,i.jsxs)("div",{className:"flex flex-col gap-y-16",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-y-4 text-center",children:[(0,i.jsx)("span",{className:"text-feature-bold",children:"Are you sure?"}),(0,i.jsxs)("p",{className:"text-body text-text-secondary",children:["invite"===e.action?"Inviting":"Accepting"," ",1===e.emails.length?e.emails[0]:"these users"," will add"," ",1===o?"one":o," more ",c()("seat",o)," ","to your team plan."]})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 divide-x divide-border-divider rounded-16 border border-border-divider",children:[(0,i.jsx)(b,{title:"Current",seatCount:n,isCurrent:!0,"data-sentry-element":"SeatCountCard","data-sentry-source-file":"SeatChangeModalContent.tsx"}),(0,i.jsx)(b,{title:"New",seatCount:a,"data-sentry-element":"SeatCountCard","data-sentry-source-file":"SeatChangeModalContent.tsx"})]}),(0,i.jsx)("div",{className:"pointer-events-none absolute inset-0 grid place-content-center",children:(0,i.jsx)("div",{className:"rounded-full border border-border-divider bg-[--container-bg] p-8",children:(0,i.jsx)(p.f,{className:"size-16","data-sentry-element":"ArrowRightIcon","data-sentry-source-file":"SeatChangeModalContent.tsx"})})})]}),(0,i.jsxs)("p",{className:"text-caption text-text-secondary",children:["Additional members are"," ",(0,h.tA)(e.seatChangePreview.data.monthlySeatPriceCents,e.seatChangePreview.data.currency)," ","per ",1===o?"month":"member/month",", billed"," ",t.billingInterval,".",(0,i.jsx)("br",{}),"You will be immediately charged a pro-rated amount of"," ",(0,h.tA)(e.seatChangePreview.data.priceCents,e.seatChangePreview.data.currency),"."]})]})}),(0,i.jsx)(s.jl,{"data-sentry-element":"ModalFooter","data-sentry-source-file":"SeatChangeModalContent.tsx",children:(0,i.jsx)("div",{className:"grid",children:(0,i.jsx)(u.$,{size:"large",onClick:async()=>{if(e.onLoadingChange(!0),"incomplete"===(await r.mutateAsync({workspaceId:t.workspace.id,preview:e.seatChangePreview.signedCostPreview})).status){g.XM.toastError("Something went wrong. Please contact support."),e.onLoadingChange(!1);return}await e.onSuccess(),e.onLoadingChange(!1)},state:e.loading?"loading":"default","data-sentry-element":"Button","data-sentry-source-file":"SeatChangeModalContent.tsx",children:"Confirm"})})})]})}function b(e){return(0,i.jsxs)("div",{className:"grid place-content-center gap-y-[2px] p-16 text-center","data-sentry-component":"SeatCountCard","data-sentry-source-file":"SeatChangeModalContent.tsx",children:[(0,i.jsx)("h3",{className:(0,f.x)("text-body-bold",!0===e.isCurrent&&"text-text-secondary"),children:e.title}),(0,i.jsx)("h3",{className:(0,f.x)("text-title-2",!0===e.isCurrent&&"text-text-disabled line-through"),children:e.seatCount}),(0,i.jsx)("p",{className:(0,f.x)("text-caption",!0===e.isCurrent&&"text-text-secondary"),children:"seats"})]})}function w(){let[e,t]=(0,o.useState)(null),r=(0,o.useRef)(null),[l,c]=(0,o.useState)(!1),d=(0,o.useCallback)(e=>{t(e),r.current=e},[]),u=(0,o.useCallback)(()=>{var e,t;null==(t=r.current)||null==(e=t.onDismiss)||e.call(t),c(!1),d(null)},[d]);return{isLoading:l,showModal:d,hideModal:u,modalContentComponent:null!==e?(0,i.jsx)(y,(0,a._)((0,n._)({},e),{loading:l,onLoadingChange:c,onBack:u})):null,modalComponent:null!==e?(0,i.jsx)(s.aF,{open:!0,onOpenChange:e=>{e||u()},size:"small",dismissible:!l,children:(0,i.jsx)(s.$m,{title:"Seat change",children:(0,i.jsx)(y,(0,a._)((0,n._)({},e),{loading:l,onLoadingChange:c}))})}):null}}},37315:(e,t,r)=>{r.d(t,{Qt:()=>i,gD:()=>o}),r(95155),r(65596);var n=r(65960),a=r(67768);function i(e){var t,r;if(!n.p)return void console.info("[analytics-debug] pinterestTrackCheckout",e);null==(t=(r=window).pintrk)||t.call(r,"track","checkout",{event_id:"checkout_".concat(e.subscriptionId),order_id:e.subscriptionId,currency:e.currency.toUpperCase(),value:(0,a.vu)(e.priceAmount,e.currency),line_items:[{product_name:e.productName,product_variant:e.billingInterval}]})}function o(e){var t,r;if(!n.p)return void console.info("[analytics-debug] pinterestTrackSignup",e);null==(t=(r=window).pintrk)||t.call(r,"track","signup",{event_id:"signup_".concat(e.userId)})}},44133:(e,t,r)=>{r.r(t),r.d(t,{AsyncRouterRefreshProvider:()=>l,useAsyncRouterRefresh:()=>c});var n=r(95155),a=r(12115),i=r(73321),o=r(57152);let s=(0,a.createContext)({refresh(){throw Error("AsyncRouterRefreshContext is not provided")},get refreshId(){throw Error("AsyncRouterRefreshContext is not provided")}});function l(e){let t=(0,o.V)((0,i.useRouter)()),r=(0,a.useRef)([]);(0,a.useEffect)(()=>{r.current=r.current.filter(t=>{let{resolve:r,refreshId:n}=t,a=n!==e.refreshId;return a&&r(),a})},[e.refreshId]),(0,a.useEffect)(()=>()=>{for(let{resolve:e}of r.current)e();r.current=[]},[]);let l=(0,a.useMemo)(()=>({refreshId:e.refreshId,async refresh(){let n=new Promise(t=>{r.current.push({resolve:t,refreshId:e.refreshId})});return t.current.refresh(),n}}),[e.refreshId,t]);return(0,n.jsx)(s.Provider,{value:l,"data-sentry-element":"AsyncRouterRefreshContext.Provider","data-sentry-component":"AsyncRouterRefreshProvider","data-sentry-source-file":"AsyncRouterRefreshContext.tsx",children:e.children})}function c(){return(0,a.useContext)(s).refresh}},44827:(e,t,r)=>{r.d(t,{LV:()=>o,op:()=>i}),r(95155),r(65596);var n=r(65960),a=r(67768);function i(e){var t,r;if(!n.p)return void console.info("[analytics-debug] metaPixelTrackPurchase",e);null==(t=(r=window).fbq)||t.call(r,"track","Purchase",{value:(0,a.vu)(e.priceAmount,e.currency),currency:e.currency.toUpperCase(),contents:[{id:e.priceId,quantity:1,name:"".concat(e.productName,"_").concat(e.billingInterval)}]},{eventID:"purchase_".concat(e.subscriptionId)})}function o(e){var t,r;if(!n.p)return void console.info("[analytics-debug] metaPixelTrackCompleteRegistration",e);null==(t=(r=window).fbq)||t.call(r,"track","CompleteRegistration",{},{eventID:"complete_registration_".concat(e.userId)})}},44915:(e,t,r)=>{r.d(t,{y:()=>n.useAsyncRouterRefresh});var n=r(44133);r(95155)},48629:(e,t,r)=>{r.d(t,{d:()=>i});let n=4*Math.ceil(32/3);class a extends Error{constructor(e,t){super(e),this.error=t}}function i(e,t){let r,i;try{r=JSON.parse(e.slice(n))}catch(e){throw new a("Not valid json",e)}if(!t)return r;try{i=t.parse(r)}catch(e){throw new a("Does not match schema",e)}return i}},51175:(e,t,r)=>{r.r(t),r.d(t,{Avatar:()=>u});var n=r(76367),a=r(30694),i=r(22514),o=r(95155),s=r(12115),l=r(59446),c=r(49084),d=r(32819);function u(e){var t,{type:r="user"}=e,u=(0,i._)(e,["type"]);let[g,m]=(0,s.useState)("loading");return(0,o.jsx)(l.bL,{className:(0,c.x)("@container","relative block shrink-0 overflow-hidden","bg-background-primary glass:bg-transparent","user"===r?"rounded-full":"rounded-[30%]"),style:{width:u.size,height:u.size},"data-sentry-element":"RadixAvatar.Root","data-sentry-component":"Avatar","data-sentry-source-file":"Avatar.tsx",children:!0===u.loading?(0,o.jsx)("div",{className:"loading-skeleton glass:loading-skeleton-glass size-full"}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l._V,(0,a._)((0,n._)({},void 0===u.imageUrl?{}:(0,d.V0)(u.imageUrl)),{alt:"string"==typeof u.name?"Avatar of ".concat(u.name):"Avatar",className:"size-full object-cover",onLoadingStatusChange:m,title:u.name,referrerPolicy:"no-referrer",draggable:!1})),(0,o.jsx)(l.H4,{className:(0,c.x)("flex size-full items-center justify-center","bg-background-tertiary text-text-secondary","glass:bg-glass-background-tertiary glass:text-glass-text-secondary","text-[45cqw] font-[652] leading-none","select-none","loading"===g&&"loading-skeleton glass:loading-skeleton-glass","loaded"===g&&"invisible"),title:u.name,"aria-label":"string"==typeof u.name?"Avatar of ".concat(u.name):"Avatar",children:"loading"!==g&&(null==(t=u.name)?void 0:t.charAt(0).toUpperCase())})]})})}},61156:(e,t,r)=>{r.d(t,{e:()=>n.Avatar});var n=r(51175)},67768:(e,t,r)=>{r.d(t,{tA:()=>i,vu:()=>a});let n={usd:{symbol:"$",denominator:100},cad:{symbol:"C$",denominator:100},aud:{symbol:"A$",denominator:100},gbp:{symbol:"\xa3",denominator:100},eur:{symbol:"€",denominator:100},sgd:{symbol:"S$",denominator:100},ils:{symbol:"₪",denominator:100},jpy:{symbol:"\xa5",denominator:1},sek:{symbol:"kr",denominator:100},krw:{symbol:"₩",denominator:1},idr:{symbol:"Rp",denominator:100},brl:{symbol:"R$",denominator:100},inr:{symbol:"₹",denominator:100}};function a(e,t){return e/("string"==typeof t&&t in n?n[t]:n.usd).denominator}function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="string"==typeof t&&t in n?n[t]:n.usd;return("up"===r.integerRoundingMethod?e=Math.ceil(e/a.denominator)*a.denominator:"down"===r.integerRoundingMethod&&(e=Math.floor(e/a.denominator)*a.denominator),(e/=a.denominator)%1==0)?"".concat(a.symbol).concat(e.toLocaleString("en-US")):"".concat(a.symbol).concat(e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}))}},76996:(e,t,r)=>{r.d(t,{gt:()=>x,YY:()=>h,Re:()=>y});var n=r(12115),a=r(23544),i=r(48963),o=r(59185),s=r(13393);async function l(e){return(await o.A.post("/api/workspace/subscription/cost-charge-for-billing-interval-change",e)).data}var c=r(91911),d=r(93825),u=r(93833),g=r(48629),m=r(17141),p=r(92126);async function f(e,t){let r=await o.A.post("/api/workspace/subscription/cost-preview-for-billing-interval-change",e,{signal:t});return r.data.error?m.Q.capture("xnfn8oy7").err(r.data.error.message,"Failed to get cost preview."):!0===r.data.value.billingIntervalUnchanged?m.Q.ok(null):m.Q.ok({data:(0,g.d)(r.data.value.signedCostPreview,d.F),signedCostPreview:r.data.value.signedCostPreview})}function h(e){var t,r,o;let{planType:d,currentBillingInterval:g,targetBillingInterval:m,workspaceId:h}=e,{costPreviewForBillingIntervalChange:v,resetIdempotencyKey:y}=function(e){let[t,r]=(0,n.useState)(6e4),a=(0,n.useRef)(void 0),i=(0,c.I)({queryKey:(0,p.sI)(["cost_preview_for_billing_interval_change"],[e]),queryFn:async t=>{var r,n;let{signal:i}=t,o=await f({billingInterval:e.billingInterval,workspaceId:e.workspaceId,idempotencyKey:a.current},i);return o.error?o.error.message:a.current=null==(n=o.value)||null==(r=n.data)?void 0:r.idempotencyKey,o},refetchInterval:t});return(0,n.useEffect)(()=>{if(i.data){if(i.data.error)return void u.XM.toastError(i.data.error.message);i.data.value&&r(Math.max(6e4,i.data.value.data.expireIn-6e4))}},[i]),{costPreviewForBillingIntervalChange:i,resetIdempotencyKey:(0,n.useCallback)(()=>{a.current=void 0},[])}}({billingInterval:m,workspaceId:h}),b=(0,i.n)(async e=>{let t=await l(e);if("incomplete"===t.status){let e=await s.i;if(!e)return t.status;let r=await e.confirmCardPayment(t["3dsRequired"].clientSecret,void 0,{});if(r.error)throw r.error;return"succeeded"===r.paymentIntent.status?"success":"incomplete"}return t.status}),w=(0,n.useCallback)(async()=>{if("string"!=typeof h||!v.data||!v.data.value)throw Error("Unable to charge billing interval change without valid workspace id and preview.");if("incomplete"===await b.mutateAsync({workspaceId:h,preview:v.data.value.signedCostPreview}))throw Error("Cost charge for billing interval change failed.");a.L.track("Upgrade Completed",{plan_type:d,billing_interval:m,previous_billing_interval:g}),y()},[b,v.data,d,g,m,h,y]);return{isErrored:!!(null==(t=v.data)?void 0:t.error),preview:null==(o=v.data)||null==(r=o.value)?void 0:r.data,previewStatus:v.status,charge:w,chargeStatus:b.status}}async function v(e){return(await o.A.post("/api/workspace/subscription/cost-charge-for-seat-change",e)).data}function y(){return(0,i.n)(async e=>{let t=await v(e);if("incomplete"===t.status){let e=await s.i;await (null==e?void 0:e.confirmCardPayment(t["3dsRequired"].clientSecret,void 0,{}).then(e=>{if(e.error)throw e.error}))}return t},{async onSuccess(){(0,p.IV)("cost_preview_for_seat_change")}})}var b=r(86417);let w=b.z.object({expireAt:b.z.number(),expireIn:b.z.number(),monthlySeatPriceCents:b.z.number(),priceCents:b.z.number(),currency:b.z.string(),upcomingInvoice:b.z.object({subscription:b.z.string(),subscription_items:b.z.tuple([b.z.object({id:b.z.string().optional(),quantity:b.z.number().int()})]),subscription_proration_date:b.z.number()}),idempotencyKey:b.z.string(),originalQuantity:b.z.number().int()});async function x(e,t){let r=await o.A.post("/api/workspace/subscription/cost-preview-for-seat-change",e,{signal:t});return"seatUnchanged"in r.data?{}:{data:(0,g.d)(r.data.signedCostPreview,w),signedCostPreview:r.data.signedCostPreview}}},85895:(e,t,r)=>{r.d(t,{X:()=>i});var n=r(12115),a=r(73321);function i(){let e=(0,a.usePathname)(),t=(0,a.useRouter)();return(0,n.useCallback)(()=>{!(e.startsWith("/concurrent/deny")||e.startsWith("/login"))&&(e.startsWith("/signup")||t.push("/concurrent/deny"))},[e,t])}},93825:(e,t,r)=>{r.d(t,{F:()=>a});var n=r(86417);let a=n.z.object({expireAt:n.z.number(),expireIn:n.z.number(),currentMonthlySeatPriceCents:n.z.number(),priceCents:n.z.number(),totalPriceCents:n.z.number(),currency:n.z.string(),upcomingInvoice:n.z.object({subscription:n.z.string(),subscription_items:n.z.tuple([n.z.object({id:n.z.string().optional(),price:n.z.string()})]),subscription_proration_date:n.z.number()}),idempotencyKey:n.z.string()})}}]);